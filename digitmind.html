<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DigitMind Game</title>
    <!-- Google Fonts for Modern Typography -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Root Variables for Consistent Styling */
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --background-color: #f5f7fa;
            --card-background: #ffffff;
            --text-color: #333333;
            --button-hover: #357ab8;
            --input-border: #d1d5db;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --font-family: 'Roboto', sans-serif;
            --selected-button-color: #f39c12;
            --selected-button-hover: #d68910;
        }

        /* Body Styling */
        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* Container Styling */
        .container {
            max-width: 600px;
            width: 100%;
            background-color: var(--card-background);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px var(--shadow-color);
            animation: fadeIn 0.5s ease-in-out;
        }

        /* Header Styling */
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 700;
        }

        /* Menu Section */
        .menu, .difficulty, .game {
            margin-top: 25px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Toggle Switch Styling */
        .toggle-switch {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .toggle-switch label {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            background-color: var(--primary-color);
            border-radius: 34px;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            transition: background-color 0.3s;
        }

        .slider::before {
            content: "";
            position: absolute;
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        input:checked + .slider {
            background-color: var(--secondary-color);
        }

        input:checked + .slider::before {
            transform: translateX(26px);
        }

        /* Toggle Labels */
        .toggle-option {
            font-weight: 500;
            color: var(--text-color);
        }

        /* Buttons Styling */
        .menu button, #startGame, .play-again-button, .difficulty button, .position-buttons button {
            padding: 12px 20px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            color: #ffffff;
            font-weight: 500;
        }

        .menu button {
            background-color: var(--primary-color);
        }

        .menu button:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        #startGame {
            background-color: var(--secondary-color);
        }

        #startGame:hover {
            background-color: #38c9ab;
            transform: translateY(-2px);
        }

        .play-again-button {
            background-color: #f39c12;
        }

        .play-again-button:hover {
            background-color: var(--selected-button-hover);
            transform: translateY(-2px);
        }

        /* Difficulty Buttons Styling */
        .difficulty-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
            flex-wrap: nowrap;
        }

        .difficulty-buttons button {
            background-color: var(--primary-color);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            font-size: 16px;
        }

        .difficulty-buttons button:hover {
            background-color: var(--button-hover);
            transform: scale(1.05);
            box-shadow: 0 4px 10px var(--shadow-color);
        }

        .difficulty-buttons button.selected {
            background-color: var(--selected-button-color);
        }

        .difficulty-buttons button.selected:hover {
            background-color: var(--selected-button-hover);
        }

        /* Feedback Section */
        .feedback {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        /* Position Container Styling */
        .position-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .position-container label {
            font-weight: 500;
            margin-bottom: 5px;
            text-align: center;
        }

        .position-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: nowrap;
        }

        .position-buttons button {
            background-color: var(--primary-color);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-size: 18px;
            color: #ffffff;
        }

        .position-buttons button:hover {
            background-color: var(--button-hover);
            transform: scale(1.05);
        }

        .position-buttons button.selected {
            background-color: var(--selected-button-color);
        }

        .position-buttons button.selected:hover {
            background-color: var(--selected-button-hover);
        }

        /* Input Fields Styling (If Any Remaining) */
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--input-border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        input[type="number"]:focus, input[type="text"]:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 5px var(--primary-color);
            outline: none;
        }

        /* Computer Guess Styling */
        .computer-guess {
            font-size: 22px;
            font-weight: 500;
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: 15px;
        }

        /* Log Styling */
        .log {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            background-color: #f0f4f8;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            box-shadow: inset 0 2px 4px var(--shadow-color);
        }

        .log p {
            margin-bottom: 8px;
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .menu button, #startGame, .play-again-button, .difficulty-buttons button, .position-buttons button {
                font-size: 14px;
                padding: 10px 16px;
                width: 40px;
                height: 40px;
            }

            input[type="number"], input[type="text"] {
                font-size: 14px;
            }

            .computer-guess {
                font-size: 20px;
            }

            .log {
                font-size: 13px;
            }
        }

        /* Fade-in Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>DigitMind</h1>
        <div class="menu">
            <p>Select Game Mode:</p>
            <!-- Toggle Switch -->
            <div class="toggle-switch">
                <span class="toggle-option">Computer Guesses</span>
                <label>
                    <input type="checkbox" id="gameModeToggle">
                    <span class="slider"></span>
                </label>
                <span class="toggle-option">You Guess</span>
            </div>
            <!-- Start Game Button -->
            <button id="startGame">Start Game</button>
            <!-- Quit Button -->
            <button id="mode0">Quit</button>
        </div>
        <div class="difficulty hidden">
            <p>Select Difficulty Level:</p>
            <div class="difficulty-buttons">
                <!-- Buttons from 1 to 10 -->
                <button data-level="1">1</button>
                <button data-level="2">2</button>
                <button data-level="3">3</button>
                <button data-level="4">4</button>
                <button data-level="5">5</button>
                <button data-level="6">6</button>
                <button data-level="7">7</button>
                <button data-level="8">8</button>
                <button data-level="9">9</button>
                <button data-level="10">10</button>
            </div>
        </div>
        <div class="game hidden">
            <!-- Game interface will be dynamically generated here -->
        </div>
    </div>

    <script>
        // JavaScript code

        // Get references to DOM elements
        const mode0Btn = document.getElementById('mode0');
        const gameModeToggle = document.getElementById('gameModeToggle');
        const startGameBtn = document.getElementById('startGame');
        const difficultyDiv = document.querySelector('.difficulty');
        const gameDiv = document.querySelector('.game');
        const menuDiv = document.querySelector('.menu');
        const difficultyButtons = document.querySelectorAll('.difficulty-buttons button');

        let gameMode = gameModeToggle.checked ? 2 : 1; // Set initial game mode based on the toggle state
        let level = 4; // Difficulty level
        let combinations = [];
        let secretCode = [];
        let allCombinations = [];
        let gameOver = false;

        // Event listener for Quit button
        mode0Btn.addEventListener('click', function() {
            // Quit the game
            alert('Thank you for playing DigitMind!');
            location.reload();
        });

        // Event listener for Game Mode Toggle
        gameModeToggle.addEventListener('change', function() {
            gameMode = this.checked ? 2 : 1; // Update game mode based on the toggle
        });

        // Event listener for Start Game button
        startGameBtn.addEventListener('click', function() {
            menuDiv.classList.add('hidden');
            difficultyDiv.classList.remove('hidden');
        });

        // Event listeners for difficulty level buttons
        difficultyButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Remove 'selected' class from all buttons
                difficultyButtons.forEach(btn => btn.classList.remove('selected'));
                // Add 'selected' class to the clicked button
                this.classList.add('selected');
                // Set the level based on the clicked button
                level = parseInt(this.getAttribute('data-level'));
                // Start the game
                difficultyDiv.classList.add('hidden');
                gameDiv.classList.remove('hidden');
                startGame();
            });
        });

        // Function to start the game
        function startGame() {
            // Generate all combinations
            allCombinations = generateAllCombinations(level);
            combinations = allCombinations.slice(); // Make a copy
            gameOver = false;
            if (gameMode === 1) {
                // Computer guesses user's combination
                computerPlayer();
            } else if (gameMode === 2) {
                // User guesses computer's combination
                humanPlayer();
            }
        }

        // Function to generate all possible combinations
        function generateAllCombinations(level) {
            let allCombinations = [];
            for (let i = 0; i < level; i++) {
                for (let j = 0; j < level; j++) {
                    for (let k = 0; k < level; k++) {
                        for (let l = 0; l < level; l++) {
                            if (i !== j && i !== k && i !== l && j !== k && j !== l && k !== l) {
                                allCombinations.push([i, j, k, l]);
                            }
                        }
                    }
                }
            }
            return allCombinations;
        }

        // Function to calculate the score
        function calculateScore(guess, code) {
            let score = {
                right_position: 0,
                wrong_position: 0
            };

            for (let i = 0; i < 4; i++) {
                if (guess[i] === code[i]) {
                    score.right_position++;
                } else if (code.includes(guess[i])) {
                    score.wrong_position++;
                }
            }
            return score;
        }

        // Function to filter combinations
        function filterCombinations(combinations, guess, score) {
            for (let i = combinations.length - 1; i >= 0; i--) {
                let combination = combinations[i];
                let s = calculateScore(guess, combination);
                if (s.right_position !== score.right_position || s.wrong_position !== score.wrong_position) {
                    combinations.splice(i, 1);
                }
            }
        }

        // Function to select a random combination
        function selectRandomCombination(combinations) {
            let index = Math.floor(Math.random() * combinations.length);
            return combinations[index];
        }

        // Function for the computer to guess the user's combination
        function computerPlayer() {
            // Set up the game interface
            gameDiv.innerHTML = '';
            let computerGuessDiv = document.createElement('div');
            computerGuessDiv.id = 'computerGuessDiv';
            computerGuessDiv.className = 'computer-guess';

            let feedbackDiv = document.createElement('div');
            feedbackDiv.className = 'feedback';

            // Correct Position Container
            let correctPositionContainer = document.createElement('div');
            correctPositionContainer.className = 'position-container';

            let rightPositionLabel = document.createElement('label');
            rightPositionLabel.textContent = 'Digits in the correct position:';

            let rightPositionButtons = document.createElement('div');
            rightPositionButtons.className = 'position-buttons';

            // Wrong Position Container
            let wrongPositionContainer = document.createElement('div');
            wrongPositionContainer.className = 'position-container';

            let wrongPositionLabel = document.createElement('label');
            wrongPositionLabel.textContent = 'Correct digits in the wrong position:';

            let wrongPositionButtons = document.createElement('div');
            wrongPositionButtons.className = 'position-buttons';

            // Create buttons for numbers 0 to 4
            for (let i = 0; i <= 4; i++) {
                let btnRight = document.createElement('button');
                btnRight.textContent = i;
                btnRight.dataset.value = i;
                rightPositionButtons.appendChild(btnRight);

                let btnWrong = document.createElement('button');
                btnWrong.textContent = i;
                btnWrong.dataset.value = i;
                wrongPositionButtons.appendChild(btnWrong);
            }

            let submitFeedbackBtn = document.createElement('button');
            submitFeedbackBtn.textContent = 'Submit Feedback';
            submitFeedbackBtn.style.backgroundColor = 'var(--primary-color)';
            submitFeedbackBtn.style.color = '#ffffff';

            let logDiv = document.createElement('div');
            logDiv.className = 'log';
            logDiv.id = 'logDiv';

            // Assemble the containers
            correctPositionContainer.appendChild(rightPositionLabel);
            correctPositionContainer.appendChild(rightPositionButtons);

            wrongPositionContainer.appendChild(wrongPositionLabel);
            wrongPositionContainer.appendChild(wrongPositionButtons);

            feedbackDiv.appendChild(correctPositionContainer);
            feedbackDiv.appendChild(wrongPositionContainer);
            feedbackDiv.appendChild(submitFeedbackBtn);

            gameDiv.appendChild(computerGuessDiv);
            gameDiv.appendChild(feedbackDiv);
            gameDiv.appendChild(logDiv);

            let guess = null;
            let rightPosition = null;
            let wrongPosition = null;

            // Function to handle button selection
            function selectPosition(buttonGroup, value) {
                // Remove 'selected' class from all buttons in the group
                buttonGroup.querySelectorAll('button').forEach(btn => btn.classList.remove('selected'));
                // Add 'selected' class to the clicked button
                buttonGroup.querySelector(`button[data-value="${value}"]`).classList.add('selected');
            }

            // Event listeners for right position buttons
            rightPositionButtons.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function() {
                    rightPosition = parseInt(this.dataset.value);
                    selectPosition(rightPositionButtons, rightPosition);
                });
            });

            // Event listeners for wrong position buttons
            wrongPositionButtons.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function() {
                    wrongPosition = parseInt(this.dataset.value);
                    selectPosition(wrongPositionButtons, wrongPosition);
                });
            });

            function performComputerMove() {
                if (combinations.length === 0) {
                    alert('Input error detected, restarting game...');
                    resetGame();
                    return;
                }
                guess = selectRandomCombination(combinations);
                // Display computer's guess
                computerGuessDiv.textContent = 'Computer\'s guess: ' + guess.join('');
                rightPosition = null;
                wrongPosition = null;
                // Clear selected buttons
                rightPositionButtons.querySelectorAll('button').forEach(btn => btn.classList.remove('selected'));
                wrongPositionButtons.querySelectorAll('button').forEach(btn => btn.classList.remove('selected'));
            }

            submitFeedbackBtn.addEventListener('click', function() {
                if (gameOver) return;

                if (rightPosition === null || wrongPosition === null) {
                    alert('Please select both numbers.');
                    return;
                }

                if (rightPosition + wrongPosition > 4) {
                    alert('The total of correct positions and wrong positions cannot exceed 4.');
                    return;
                }

                let score = {
                    right_position: rightPosition,
                    wrong_position: wrongPosition
                };

                // Log the feedback
                let logEntry = document.createElement('p');
                logEntry.textContent = 'Guess: ' + guess.join('') + ' | Correct position: ' + rightPosition + ' | Correct digit, wrong position: ' + wrongPosition;
                logDiv.appendChild(logEntry);

                if (rightPosition === 4) {
                    alert('The computer has guessed your combination!');
                    gameOver = true;

                    submitFeedbackBtn.disabled = true;

                    let playAgainBtn = document.createElement('button');
                    playAgainBtn.textContent = 'Play Again';
                    playAgainBtn.className = 'play-again-button';
                    playAgainBtn.addEventListener('click', function() {
                        resetGame();
                    });
                    gameDiv.appendChild(playAgainBtn);
                    return;
                }

                filterCombinations(combinations, guess, score);

                performComputerMove();
            });

            performComputerMove();
        }

        // Function for the user to guess the computer's combination
        function humanPlayer() {
            // Computer selects a secret code
            secretCode = selectRandomCombination(combinations);

            // Set up the game interface
            gameDiv.innerHTML = '';

            let instructionDiv = document.createElement('div');
            instructionDiv.textContent = 'Enter your guess (4 distinct digits between 0 and ' + (level - 1) + '):';

            let guessInput = document.createElement('input');
            guessInput.type = 'text';
            guessInput.maxLength = 4;
            guessInput.className = 'guess-input';

            let submitGuessBtn = document.createElement('button');
            submitGuessBtn.textContent = 'Submit Guess';
            submitGuessBtn.style.backgroundColor = 'var(--primary-color)';
            submitGuessBtn.style.color = '#ffffff';

            let feedbackDiv = document.createElement('div');
            feedbackDiv.className = 'feedback';

            let logDiv = document.createElement('div');
            logDiv.className = 'log';
            logDiv.id = 'logDiv';

            gameDiv.appendChild(instructionDiv);
            gameDiv.appendChild(guessInput);
            gameDiv.appendChild(submitGuessBtn);
            gameDiv.appendChild(feedbackDiv);
            gameDiv.appendChild(logDiv);

            submitGuessBtn.addEventListener('click', function() {
                if (gameOver) return;

                let input = guessInput.value;
                if (input.length !== 4) {
                    alert('Please enter a 4-digit number.');
                    return;
                }
                let playerGuess = input.split('').map(Number);
                if (playerGuess.some(isNaN)) {
                    alert('Please enter only digits.');
                    return;
                }
                if (new Set(playerGuess).size !== 4) {
                    alert('Digits must be distinct.');
                    return;
                }
                if (playerGuess.some(d => d < 0 || d >= level)) {
                    alert('Digits must be between 0 and ' + (level - 1) + '.');
                    return;
                }

                let score = calculateScore(playerGuess, secretCode);

                // Provide feedback to the player
                feedbackDiv.textContent = 'Digits in the right position: ' + score.right_position + ', Digits in wrong position: ' + score.wrong_position;

                // Log the guess and feedback
                let logEntry = document.createElement('p');
                logEntry.textContent = 'Guess: ' + playerGuess.join('') + ' | Correct position: ' + score.right_position + ' | Wrong position: ' + score.wrong_position;
                logDiv.appendChild(logEntry);

                if (score.right_position === 4) {
                    alert('Congratulations, you have guessed the combination!');
                    gameOver = true;

                    guessInput.disabled = true;
                    submitGuessBtn.disabled = true;

                    let playAgainBtn = document.createElement('button');
                    playAgainBtn.textContent = 'Play Again';
                    playAgainBtn.className = 'play-again-button';
                    playAgainBtn.addEventListener('click', function() {
                        resetGame();
                    });
                    gameDiv.appendChild(playAgainBtn);
                    return;
                }

                guessInput.value = '';
            });
        }

        // Function to reset the game
        function resetGame() {
            // Reset game variables
            gameMode = gameModeToggle.checked ? 2 : 1;
            level = 4;
            combinations = [];
            secretCode = [];
            allCombinations = [];
            gameOver = false;

            // Remove 'selected' class from all difficulty buttons
            difficultyButtons.forEach(btn => btn.classList.remove('selected'));

            // Show the menu
            menuDiv.classList.remove('hidden');
            gameDiv.classList.add('hidden');
            gameDiv.innerHTML = '';
            difficultyDiv.classList.add('hidden');
        }
    </script>

</body>
</html>
